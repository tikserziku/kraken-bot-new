{% extends "base.html" %}

{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-2xl mb-4">Bot Status</h1>
    <div class="bg-white p-4 rounded shadow mb-4">
        <p>Status: {{ "Running" if is_running else "Stopped" }}</p>
        <p>Balance: ${{ balance }}</p>
        <p>BTC: {{ btc_amount }}</p>
        <p>Price: ${{ current_price }}</p>
    </div>
    
    <div class="bg-white p-4 rounded shadow mb-4">
        <canvas id="priceChart"></canvas>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
const ctx = document.getElementById('priceChart').getContext('2d');
const chart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [{
            label: 'BTC Price',
            data: []
        }]
    }
});

function updateChart() {
    fetch('/api/price_history')
        .then(r => r.json())
        .then(data => {
            chart.data.labels = data.labels;
            chart.data.datasets[0].data = data.prices;
            chart.update();
        });
}

setInterval(updateChart, 30000);
updateChart();
</script>
{% endblock %}

